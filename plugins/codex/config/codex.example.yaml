# Fractary Codex Plugin Configuration
# This file configures the codex plugin for knowledge management and sync operations
# CLI version: Use this format with @fractary/cli and @fractary/codex SDK

version: "2.0"

# Organization identification
organization: fractary

# Codex repository (naming convention: codex.{org}.{tld})
codex_repo: codex.fractary.com

# Sync configuration (v0.7.0+ format)
# Uses directional patterns: to_codex (push local→codex) and from_codex (pull codex→local)
sync:
  # Files to push FROM local TO codex repository
  to_codex:
    include:
      - "docs/**"
      - "CLAUDE.md"
      - "README.md"
      - ".claude/**"
      - "standards/**"
      - "guides/**"
    exclude:
      - "docs/private/**"
      - "docs/drafts/**"

  # Files to pull FROM codex repository TO local
  # Use codex:// URIs with placeholders: {org}, {project}, {codex_repo}
  from_codex:
    include:
      - "codex://{org}/{codex_repo}/docs/**"      # Shared docs from codex (includes standards, guides)
      # Examples of other patterns:
      # - "codex://{org}/{project}/**"             # Own project files from codex
      # - "codex://{org}/other.project/specs/**"   # Specific project's specs

  # Global exclude patterns (applied to both directions)
  exclude:
    - "**/.git/**"
    - "**/node_modules/**"
    - "**/.env"
    - "**/.env.*"
    - "**/*.log"
    - "**/dist/**"
    - "**/build/**"
    - "**/.DS_Store"
    - "**/credentials.json"
    - "**/*secret*"
    - "**/*password*"

# Auto-sync: Automatically sync on commit (requires hooks)
auto_sync: false

# Environment-to-branch mappings for codex repository
environments:
  dev:
    branch: test
    description: Development environment
  test:
    branch: test
    description: Test/QA environment
  staging:
    branch: main
    description: Staging environment (defaults to prod branch)
  prod:
    branch: main
    description: Production environment

# Handler configuration (platform-specific behavior)
handlers:
  sync:
    active: github
    options:
      github:
        parallel_repos: 5
        deletion_threshold: 50
        deletion_threshold_percent: 20
        sparse_checkout: true
        retry_attempts: 3
        retry_delay: 5

# Logging configuration
logging:
  enabled: true
  log_file: .fractary/plugins/codex/logs/audit.log
  level: info  # Options: debug, info, warn, error

# Cache configuration (managed by @fractary/codex SDK)
cache:
  ttl_days: 7
  max_size_mb: 0  # 0 = unlimited
  auto_cleanup: true
  cleanup_interval_days: 7

# CLI-specific settings
cli:
  # Default format for CLI output
  output_format: json  # Options: json, yaml, text

  # Enable verbose logging in CLI commands
  verbose: false

  # Color output (auto-detected if terminal supports it)
  color: auto  # Options: always, never, auto
